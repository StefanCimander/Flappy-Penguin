<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Flappy Penguin</title>
    <link rel="stylesheet" href="css/style.css">

    <script src="/socket.io/socket.io.js"></script>

    <script src="js/easeljs-0.8.2.min.js"></script>

    <script src="js/config.js"></script>
    <script src="js/assets.js"></script>
    <script src="js/setup.js"></script>
    <script src="js/collision.js"></script>
    <script src="js/logic.js"></script>
    <script src="js/keyboard.js"></script>

    <script>
        window.addEventListener('load', function (e) {
            var canvas = document.getElementById('stage');
            canvas.width = document.body.getBoundingClientRect().width;
            canvas.height = document.body.getBoundingClientRect().height * 0.8;

            var game = {};
                game.paused = true;
                game.stage = new createjs.Stage('stage')
            initStage(game.stage);
                game.scene = generateScene(game.stage);
            setupGUI(game.stage, game.scene);
            setupGame(game);

            game.breathFunction = breath(game);
            console.log(game.breath);

            document.addEventListener('keydown', keyboardHandler(game));

            createjs.Ticker.setInterval(1000 / FPS);
            createjs.Ticker.setFPS(FPS);
            createjs.Ticker.addEventListener("tick", function () {
                game.stage.update();
            });

            var socket = io('127.0.0.1:3000');
            window.socket = socket;
            socket.on('arduino-data', (data) => {
                console.log("Arduino:", data);
                if (data.breath) {
                    console.log("yay");
                    game.breathFunction();
                }
            });

            window.setInterval(function () { gameUpdate(game); }, 1000 / UPDATE_RATE);
        });
    </script>
</head>
<body>
    <canvas id="stage" width="500" height="512"></canvas>
</body>
</html>
